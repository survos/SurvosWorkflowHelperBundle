{% set transitions = workflow_transitions(entity, flowCode) %}
{% set action = (entity.id|default(false))
    ? path('project_workflow_transition', {id: entity.id|default(null), flowCode: flowCode})
    : path('survos_workflow', {flowCode: flowCode})
%}
<form action="{{ action }}" method="GET">
    <input type="hidden" name="class" value="{{ class|default(entity_class(entity)) }}"/>
    <input type="hidden" name="states" value="{{ entity ? entity.marking|json_encode }}"/>
    <input type="hidden" name="referrer_url" value="{{ app.request.uri }}"/>
    <div class="btn-group">
        {% if transitions %}
            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"
                    title="{{ flowCode }} Workflow"
                    aria-haspopup="true" aria-expanded="false">
                Status: {{ entity.markingDisplay }} <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                {% for transition in transitions %}
                    {% set tName = transition.name %}
                    <li>
                        <button type="submit" class="btn btn-link" name="transitionName" value="{{ tName }}"
                                title="{{ 'workflow.%s.transition.%s.description'|format(flowCode, tName)|trans([], 'workflow_messages') }}"
                                {% if not workflow_can(entity, tName, flowCode) -%}disabled{%- endif -%}
                        >
                            {{ 'workflow.%s.transition.%s.label'|format(flowCode, tName)|trans([], 'workflow_messages')}}
                        </button>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
        {% if app.request.get('hard') %}
            <button type="submit" name="transition" value="hard_reset" class="btn btn-danger">
                Hard Reset
            </button>
        {% endif %}

    </div>
</form>
{% if not transitions %}
    <p>
        <strong>No actions</strong>
    </p>
{% endif %}